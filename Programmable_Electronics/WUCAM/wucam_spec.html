<!DOCTYPE html>
<html>
<head>
 <meta charset="utf-8" />
 <meta name="viewport" content="width=device-width, initial-scale=1" />
 <link rel="stylesheet" href="../polycop.css" />
 <title>WUCAM Specification</title>
</head>
<body>
<style>
ul	{ margin-top: 6px }
p	{ margin-bottom: 6px }
</style>
<div class="large">
<center>
<h1>WUCAM Specification V0.9 preliminary</h1>
</center>

<h3>Radio communication parameters</h3>

<ul>
<li>unlicensed ISM band EU433
	<ul><li>UHF 433.05 MHz to 434.79 MHz</li>
	<li>emitted power &lt; 10mW</li>
	<li>channel occupation &lt; 10% of time</li>
	</ul></li>
<li>nominal carrier frequency : 434.000 MHz, single shared channel</li>
<li>half-duplex transceiver</li>
<li>digital smooth frequency modulation GFSK (Gaussian Frequency Shift Keying)
	<ul><li>frequency deviation +- 19 kHz</li>
	<li>max data rate 38.4 kbit/s</li>
	<li>receiver bandwidth 102 kHz</li>
	</ul></li>
<li>hardware formatted packets
	<ul><li>variable length up to 61 bytes</li>
	<li>hardware managed preamble (32 bits) and sync pattern (32 bits)</li>
	<li>hardware computed CRC (16 bits)</li>
	</ul></li>
<li>additionnal error detection: software computed <a href="CRC" target="_blank">CRC32-AIXM</a></li>
<li>integrated single chip digital transceiver <a href="CC1101/CC1101.pdf" target="_blank">CC1101</a> by TI</li>
</ul>

<h3>Message format</h3>

<object id="obj1" type="image/svg+xml" data="packet.svg"></object>

<p>On this diagram, field lengths (blue) are indicated in bytes</p>
<p>Fields PREAMBLE (bit sync pattern), SYNC WORD (byte sync pattern) and CRC16 are automatically managed by the CC1101 hardware.<p>
<p>The FIFO CONTENTS fields are managed by software (FIFO means First-In First-Out buffer).</p>
<ul><li>Before transmission, the software must write these fields in the TX FIFO (transmit buffer)</li>
<li>Upon reception, the software must read these fields from the RX FIFO (receive buffer)</li>
</ul>
<p>The LEN field (length) is created by the software, but read by the CC1101 in both transmission and reception, for determining where the message ends. This is the total length of the other fields in the FIFO (maximum 61 bytes)</p>
<p>The ADR, OPCODE and CRC fields are WUCAM-specific</p>
<ul><li>ADR contains the flight number (aircraft identification) on 7 bits, with the MSB set when the message comes from the WUCAM</li>
<li>OPCODE (operation code) on 8 bits identifies the type of the message, determining the interpretation of the other fields</li>
<li>CRC32 is present only on some specific messages requiring a higher safety level. It is computed on the whole FIFO contents except LEN and itself (which is on LEN-4 bytes).</li>
</ul>   
<p>At 38.4 kbits/s, the total RF time taken by a message is :</p>
<pre>Trf = (LEN + 11) * 0.208 ms</pre>

<h3>Message contents</h3>

<h4>Coordinate system and units</h4>
<p>Like Rejeu, Wucam uses the Cautra coordinates system, which is a plane local orthogonal projection.<br>
X is from West to East, Y is from South to North</p>
<table class="bw">
<tr><td>position</td><td>Nm (nautical mile, 1852m)</td></tr>
<tr><td>speed</td><td>Knot (1 Nm/h)</td></tr>
<tr><td>heading, angle</td><td>degree (0 to 359)</td></tr>
<tr><td>altitude</td><td>Fligh level unit (100 feet)</td></tr>
<tr><td>time</td><td>second</td></tr>
</table>
<p>Wucam identifies waypoints by numbers which are indexes in the waypoint list (starting with 0).<br>
The mapping with 3 or 5 letters waypoint names should be handled by the ground system</p>

<h4>Message categories</h4>
<table class="bw">
<tr><th>Dir.</th><th>Description</th><th>Opcode</th><th>Data</th><th>CRC</th><th>LEN</th></tr>
<tr><th colspan="6">Pilot Orders, aknowledged by WILCO or UNABLE</th></tr>
<tr><td>Up</td><td>New flight plan</td><td>0x70</td><td>List of waypoints (8 bits IDs)<br>maximum 55 waypoints</td><td>Y</td><td>Var</td></tr>
<tr><td>Up</td><td>Proceed direct to</td><td>0x4A</td><td>Waypoint (8 bits ID)</td><td>Y</td><td>7</td></tr>
<tr><td>Up</td><td>Turn</td><td>0x5E</td><td>New heading (degrees, 16 bits)</td><td>Y</td><td>8</td></tr>
<tr><td>Up</td><td>Climb or Descend</td><td>0x14</td><td>New flight level (16 bits)</td><td>Y</td><td>8</td></tr>

<tr><th colspan="6">Response to Pilot Orders</th></tr>
<tr><td>Dn</td><td>WILCO: message understood and complied with</td><td>0x00</td><td>CRC of the order which is acknowledged</td><td>N</td><td>6</td></tr>
<tr><td>Dn</td><td>UNABLE: message understood and refused</td><td>0x01</td><td>Error code (byte),<br>CRC of the order which is acknowledged</td><td>N</td><td>7</td></tr>

<tr><th colspan="6">Pilot Info Requests</th></tr>
<tr><td>Up</td><td>Request flight plan</td><td>0x71</td><td>None</td><td>N</td><td>2</td></tr>
<tr><td>Up</td><td>Request waypoint coord</td><td>0x75</td><td>Start ID (byte)</td><td>N</td><td>3</td></tr>
<tr><td>Up</td><td>Request altitude limits</td><td>0x15</td><td>None</td><td>N</td><td>2</td></tr>
<tr><td>Up</td><td>Request rates</td><td>0x79</td><td>None</td><td>N</td><td>2</td></tr>


<tr><th colspan="6">Pilot Info Request Answers</th></tr>
<tr><td>Dn</td><td>Current flight plan</td><td>0x72</td><td>List of remaining waypoints (8-bit IDs)</td><td>Y</td><td>Var</td></tr>
<tr><td>Dn</td><td>Waypoint coordinates</td><td>0x76</td><td>Start ID (byte),<br>X-Y pairs (Nm/100, 16bits signed)</td><td>Y</td><td>Var</td></tr>
<tr><td>Dn</td><td>Altitude limits</td><td>0x16</td><td>Min and Max flight levels</td><td>Y</td><td>10</td></tr>
<tr><td>Dn</td><td>Current rates</td><td>0x7A</td><td>Climb and Descend rate (ft/mn, 16 bits),<br>
	Bank angle (degrees, 8 bits)</td><td>Y</td><td>11</td></tr>

<tr><th colspan="6">Periodic position report</th></tr>
<tr><td>Dn</td><td>Vector report</td><td>0x42</td><td>X, Y (Nm/100, 16bits signed),<br>
	vector speed VX, VY (knots/10, 16 bits signed),<br> flight level (16 bits), timestamp (s, 16 bits)</td><td>N</td><td>14</td></tr>

<tr><th colspan="6">Simulation directives </th></tr>
<tr><td>Up</td><td>Pause</td><td>0x81</td><td>None</td><td>N</td><td>2</td></tr>
<tr><td>Up</td><td>Resume</td><td>0x82</td><td>None</td><td>N</td><td>2</td></tr>
<tr><td>Up</td><td>Set clock rate</td><td>0x83</td><td>Simulation speed multiplier (s/s byte)</td><td>N</td><td>3</td></tr>
<tr><td>Up</td><td>Simulation Reset</td><td>0x84</td><td>None</td><td>N</td><td>2</td></tr>

</table>

<h4>Error codes for Unable</h4>
<table class="bw">
<tr><td>0x70</td><td>Unknown waypoint</td></tr>
<tr><td>0x5E</td><td>Incorrect heading</td></tr>
<tr><td>0x14</td><td>Out-of-range flight level</td></tr>
</table>

<h4>Messages approximate mapping</h4>
<table class="bw">
<tr><th>WUCAM</th><th>CPDLC</th><th>Rejeu</th></tr>
<tr><td>Wilco</td><td>DM0</td><td></td></tr>
<tr><td>Unable</td><td>DM1</td><td></td></tr>
<tr><td>New Flight plan</td><td></td><td>SetPln (with time=origin)</td></tr>
<tr><td>Request flight plan</td><td></td><td>GetPln</td></tr>
<tr><td>Request waypoint coord</td><td></td><td>GetBeaconsInfos</td></tr>
<tr><td>Proceed direct to</td><td>UM74</td><td>AircraftDirect</td></tr>
<tr><td>Turn</td><td>UM94</td><td>AircraftHeading</td></tr>
<tr><td>Climb or Descend</td><td>UM20,23</td><td>AircraftLevel (with rate=PERFO)</td></tr>
<tr><td>Vector report</td><td></td><td>TrackMovedEvent</td></tr>
<tr><td>Pause</td><td></td><td>ClockStop</td></tr>
<tr><td>Resume</td><td></td><td>ClockStart</td></tr>
<tr><td>Set clock rate</td><td></td><td>SetClock Rate</td></tr>
</table>

<h3>WUCAM autopilot features</h3>
<ul><li>Flight plan : When a new flight plan is received, the current plan is entirely canceled, and a course is set to the first waypoint of the new plan.
If the aircraft is too close to this waypoint, the waypoint is skipped.</li>
<li>Direct to : a course is set to the new waypoint. If this waypoint is in the current flight plan, the plan will be continued after this waypoint is reached, otherwise the plan will be entirely canceled. In both cases, if the aircraft is too close to this waypoint when receiving the order, the waypoint is skipped.</li>
<li>Free run : when the aircraft has reached the last waypoint of the plan, or the plan is empty, it continues at constant heading and altitude until receiving a new pilot order.</li>
<li>Speed optimization : the autopilot sets the air speed and the climb and descend rates taking into account the altitude and the atmospheric conditions, applying a fuel economy strategy.<br>It reports the X and Y components of the ground speed computed from GPS and inertial instruments</li>
<li>The autopilot computes the turn rate and the turn radius according to the nominal bank angle</li>
</ul>

<h3>Transmission errors handling</h3>

</body></html>
